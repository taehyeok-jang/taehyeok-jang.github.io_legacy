<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Java Date Time API | Keep Calm and HAKUNA MATATA</title>
<meta name="generator" content="Jekyll v4.3.3">
<meta property="og:title" content="Java Date Time API">
<meta name="author" content="taehyeok-jang">
<meta property="og:locale" content="en_US">
<meta name="description" content="Introduction">
<meta property="og:description" content="Introduction">
<link rel="canonical" href="/jekyll-theme-yat/java/2022/02/19/java-date-time-api.html">
<meta property="og:url" content="/jekyll-theme-yat/java/2022/02/19/java-date-time-api.html">
<meta property="og:site_name" content="Keep Calm and HAKUNA MATATA">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-02-19T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Java Date Time API">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"taehyeok-jang"},"dateModified":"2022-02-19T00:00:00+00:00","datePublished":"2022-02-19T00:00:00+00:00","description":"Introduction","headline":"Java Date Time API","mainEntityOfPage":{"@type":"WebPage","@id":"/jekyll-theme-yat/java/2022/02/19/java-date-time-api.html"},"url":"/jekyll-theme-yat/java/2022/02/19/java-date-time-api.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/jekyll-theme-yat/assets/css/main.css">
  <script src="/jekyll-theme-yat/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="/jekyll-theme-yat/feed.xml" title="Keep Calm and HAKUNA MATATA">
<script>
  function initGoogleAnalytics() {
    var doNotTrack = (window.doNotTrack === "1" || navigator.doNotTrack === "1" ||
      navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1");
    var enableDNT = "true" == "true";

    if (!enableDNT || !doNotTrack) {
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'G-WWZ625TGVC', 'auto');
      ga('send', 'pageview');
    }
  }
  window.addEventListener("load", initGoogleAnalytics);
</script>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #ff4e00;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: uppercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
</head>
<body>



























































































































<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/jekyll-theme-yat/">
  <img class="site-favicon" title="Keep Calm and HAKUNA MATATA" src="" onerror="this.style.display='none'">
  Keep Calm and HAKUNA MATATA
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/jekyll-theme-yat/about.html">ABOUT</a><a class="page-link" href="/jekyll-theme-yat/archives.html">ARCHIVES</a><a class="page-link" href="/jekyll-theme-yat/categories.html">CATEGORIES</a><a class="page-link" href="/jekyll-theme-yat/">HOME</a><a class="page-link" href="/jekyll-theme-yat/tags.html">TAGS</a>









<span class="page-link">



<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://cdn.countryflags.com/thumbs/united-states-of-america/flag-400.png" title="English">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="fr">
          
          <img src="https://cdn.countryflags.com/thumbs/france/flag-400.png" title="French">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="zh-CN">
          
          <img src="https://cdn.countryflags.com/thumbs/china/flag-400.png" title="Chinese(Simple)">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ja">
          
          <img src="https://cdn.countryflags.com/thumbs/japan/flag-400.png" title="Japanese">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ko">
          
          <img src="https://cdn.countryflags.com/thumbs/south-korea/flag-400.png" title="Korean">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ru">
          
          <img src="https://cdn.countryflags.com/thumbs/russia/flag-400.png" title="Russian">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  // Links to cross-origin destinations are unsafe
  var gll = document.getElementsByClassName('goog-logo-link')[0];
  if (gll) {
    gll.setAttribute('rel', 'noopener');
  }

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  function initHeader() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  }
  document.addEventListener('DOMContentLoaded', initHeader);
</script>
















































































































































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    hashValue = decodeURIComponent(hashValue);
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('auto' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">Java Date Time API</h1>
  <h2 class="post-subtitle"></h2>

  <p class="post-meta">
    <time class="dt-published" datetime="2022-02-19T00:00:00+00:00" itemprop="datePublished"><i class="fa fa-calendar"></i> Feb 19, 2022
    </time>

    
    
































    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 9 mins</span>
  </p>
<div class="post-tags">
<a class="post-tag" href="/jekyll-theme-yat/tags.html#java">#java</a><a class="post-tag" href="/jekyll-theme-yat/tags.html#date">#date</a><a class="post-tag" href="/jekyll-theme-yat/tags.html#time">#time</a><a class="post-tag" href="/jekyll-theme-yat/tags.html#timezone">#timezone</a>
</div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <h2 id="introduction">Introduction</h2>

<p>Java에서 날짜 및 시간과 관련된 작업을 하다보면 Date, Calendar, Instant, ZonedDateTime 등 비슷한 목적의 여러 클래스들이 있어서 헷갈렸던 적이 있을 것입니다. 이는 Java 1.0에서 Date 클래스가 처음 도입된 이후로 여러가지 문제점들이 발견되어 이를 개선하기 위한 클래스들이 새로 생겨났기 때문인데요. Joda Time과 같은 오픈소스 라이브러리가 개발되기도 했지만 Java 8의 java.time 패키지가 도입되면서 Java 기본 패키지에서도 충분한 기능을 제공할 수 있게 되었습니다.</p>

<p>이번 글에서는 Java의 역사에서 관련 클래스들이 어떻게 발전했는지를 살펴보고, 그리고 나아가 어플리케이션에서 날짜 및 시간의 일관성을 지키기 위한 규칙에 대해서도 간단히 알아보겠습니다.</p>

<h2 id="a-brief-history">A Brief History</h2>

<h3 id="javautildate-java-10">java.util.Date (Java 1.0)</h3>

<p><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Date.html">https://docs.oracle.com/javase/8/docs/api/java/util/Date.html</a></p>

<p>가장 먼저 출시된 클래스는 Java 1.0의 java.util.Date 클래스입니다. 공식 문서의 정의대로 이 클래스는 단순 날짜가 아니라 특정한 시간을 millisecond 단위로 나타냅니다. Date 클래스는 기본적인 사용 방법과 유효성 측면에서 여러 문제가 있었습니다.</p>

<p>첫번째로, 연도는 1900년부터 시작되었고 월은 0부터 시작하여 직관적인 사용이 어려웠습니다. 예를 들어 2020년 06월 10일을 나타내기 위해서는 아래와 같이 Date 인스턴스를 생성해야 합니다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Date</span> <span class="n">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">(</span><span class="mi">120</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
</code></pre></div></div>

<p>두번째로, 입력된 날짜에 대한 유효성 검증이 제대로 지원되지 않았습니다. 아래의 예시처럼 생성자에 2020년 05월 31일을 입력하면 아무런 예외나 경고 메시지 없이 2020년 06월 01일로 Date 인스턴스가 생성됩니다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Date</span> <span class="n">date1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">(</span><span class="mi">120</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">31</span><span class="o">);</span>
<span class="nc">Date</span> <span class="n">date2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">(</span><span class="mi">120</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>

<span class="n">assertEquals</span><span class="o">(</span><span class="n">date1</span><span class="o">,</span> <span class="n">date2</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="javautilcalendar-java-11">java.util.Calendar (Java 1.1)</h3>

<p>Java 1.1에서 java.util.Calendar 클래스가 도입되면서 Date 클래스와 관련된 몇가지 문제점들이 개선되었지만 여전히 여러 문제점들이 있었습니다.</p>

<p>월이 여전히 0부터 시작합니다. Caldenar 클래스에서 <code class="language-plaintext highlighter-rouge">Calendar.JULY</code> 와 같은 상수들을 지원했지만 정수를 그대로 사용할 수 있는 이상 잘못 사용될 가능성은 여전히 존재합니다.</p>

<p>두번째로, Date와 마찬가지로 Calendar 클래스 또한 mutable이어서 set method로 값을 변경할 수 있습니다. 이 클래스들의 인스턴스가 여러 객체에서 공유되거나 여러 스레드에서 동시접근한다면 예상하지 못한 문제가 발생할 수 있습니다.</p>

<p>Time zone을 관리하기가 어렵습니다. TimeZone 인스턴스 생성 시 <code class="language-plaintext highlighter-rouge">Asia/Seoul</code> 이 아니라 실수로 <code class="language-plaintext highlighter-rouge">Seoul/Asia</code> 를 입력하면 아무런 예외가 발생하지 않으면서 Time zone은 <code class="language-plaintext highlighter-rouge">GMT</code> 로 생성됩니다. 이는 잠재적인 오류의 가능성을 가지고 있습니다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">TimeZone</span> <span class="n">zone</span> <span class="o">=</span> <span class="nc">TimeZone</span><span class="o">.</span><span class="na">getTimeZone</span><span class="o">(</span><span class="s">"Seoul/Asia"</span><span class="o">);</span>
<span class="nc">Calendar</span> <span class="n">calendar</span> <span class="o">=</span> <span class="nc">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">zone</span><span class="o">);</span> 

<span class="n">assertEquals</span><span class="o">(</span><span class="n">calendar</span><span class="o">.</span><span class="na">getTimeZone</span><span class="o">(),</span> <span class="s">"GMT"</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="javatime-java-8-jsr-310">java.time (Java 8, JSR 310)</h3>

<p>Java 8에서 JSR 310 표준을 통합하여 java.time 패키지를 도입했습니다. 이 패키지는 기존 클래스들의 문제들을 해결하고 날짜와 시간을 관리하기 위한 기능을 제공합니다.</p>

<ol>
  <li>충분히 효율적인 API를 제공합니다.</li>
  <li>Date, Time, Instant, TimeZone을 위한 표준을 지원합니다.</li>
  <li>객체 간 공유 및 스레드 안정성을 위해 immutable로 구현하였습니다.</li>
</ol>

<p><a href="https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html">https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html</a></p>

<p>아래는 java.time 패키지 내 일부 클래스들입니다. 타임라인 상에서 특정 순간을 나타내기 위한 Instant 클래스, time zone 없이 날짜, 시간을 표기하기 위한 LocalDate, LocalTime, LocalDateTime 클래스가 있습니다. 그리고 time zone을 offset이나 id로 (ZoneOffset, ZoneId) 나타낼 수 있으며 OffsetDateTime, ZonedDateTime 클래스를 통해서 특정 지역에서 날짜와 시간과 관련된 완전한 정보를 표현할 수 있습니다. 모든 클래스는 날짜와 시간과 관련된 국제 표준인 <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO-8601</a>을 따르고 있습니다.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Class</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html">Instant</a></td>
      <td style="text-align: left">An instantaneous point on the time-line.</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html">LocalDate</a></td>
      <td style="text-align: left">A date without a time-zone in the ISO-8601 calendar system, such as <code class="language-plaintext highlighter-rouge">2007-12-03</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/LocalDateTime.html">LocalDateTime</a></td>
      <td style="text-align: left">A date-time without a time-zone in the ISO-8601 calendar system, such as <code class="language-plaintext highlighter-rouge">2007-12-03T10:15:30</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/LocalTime.html">LocalTime</a></td>
      <td style="text-align: left">A time without a time-zone in the ISO-8601 calendar system, such as <code class="language-plaintext highlighter-rouge">10:15:30</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/OffsetDateTime.html">OffsetDateTime</a></td>
      <td style="text-align: left">A date-time with an offset from UTC/Greenwich in the ISO-8601 calendar system, such as <code class="language-plaintext highlighter-rouge">2007-12-03T10:15:30+01:00</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/OffsetTime.html">OffsetTime</a></td>
      <td style="text-align: left">A time with an offset from UTC/Greenwich in the ISO-8601 calendar system, such as <code class="language-plaintext highlighter-rouge">10:15:30+01:00</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/ZonedDateTime.html">ZonedDateTime</a></td>
      <td style="text-align: left">A date-time with a time-zone in the ISO-8601 calendar system, such as <code class="language-plaintext highlighter-rouge">2007-12-03T10:15:30+01:00 Europe/Paris</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/ZoneId.html">ZoneId</a></td>
      <td style="text-align: left">A time-zone ID, such as <code class="language-plaintext highlighter-rouge">Europe/Paris</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/ZoneOffset.html">ZoneOffset</a></td>
      <td style="text-align: left">A time-zone offset from Greenwich/UTC, such as <code class="language-plaintext highlighter-rouge">+02:00</code>.</td>
    </tr>
  </tbody>
</table>

<h2 id="date-time-apis">Date, Time APIs</h2>

<p>Java에서 날짜, 시간과 관련하여 여러 유용한 API들을 소개합니다. 레거시를 포함하는 시스템에서는 관련된 여러 클래스들이 섞여서 사용되고 있을텐데요. 하위 호환을 반드시 지원해야 하는 경우가 아니라면 java.time 패키지에 있는 클래스들로 변환하여 날짜와 시간을 명확하게 표현하는 것을 권장합니다.</p>

<h3 id="current-date-time">Current Date, Time</h3>

<ul>
  <li>Date</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nc">Date</span><span class="o">();</span>
</code></pre></div></div>

<ul>
  <li>LocalDate, LocalDateTime</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
<span class="nc">LocalTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
<span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="convert-between-old--new">Convert between Old &amp; New</h3>

<ul>
  <li>Date -&gt; ZonedDateTime</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// zoneId = ZoneId.systemDefault();</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="nc">ZonedDateTime</span> <span class="nf">convert</span><span class="o">(</span><span class="nd">@Nonnull</span> <span class="nc">Date</span> <span class="n">date</span><span class="o">,</span> <span class="nc">ZoneId</span> <span class="n">zoneId</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">date</span><span class="o">.</span><span class="na">toInstant</span><span class="o">().</span><span class="na">atZone</span><span class="o">(</span><span class="n">zoneId</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>ZonedDateTime -&gt; Date</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="nc">Date</span> <span class="nf">convert</span><span class="o">(</span><span class="nc">ZonedDateTime</span> <span class="n">zonedDateTime</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="nc">Date</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">zonedDateTime</span><span class="o">.</span><span class="na">toInstant</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="formatting">Formatting</h3>

<ul>
  <li>Date -&gt; String</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">SimpleDateFormat</span> <span class="no">DATE_FORMAT</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleDateFormat</span><span class="o">(</span><span class="s">"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"</span><span class="o">,</span> <span class="nc">Locale</span><span class="o">.</span><span class="na">getDefault</span><span class="o">());</span>

<span class="kd">public</span> <span class="nc">String</span> <span class="nf">dateToISOString</span><span class="o">(</span><span class="nd">@Nonnull</span> <span class="nc">Date</span> <span class="n">date</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="no">DATE_FORMAT</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">date</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>String -&gt; Date</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">SimpleDateFormat</span> <span class="no">DATE_FORMAT</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleDateFormat</span><span class="o">(</span><span class="s">"yyyy-MM-dd"</span><span class="o">,</span> <span class="nc">Locale</span><span class="o">.</span><span class="na">getDefault</span><span class="o">());</span>

<span class="kd">public</span> <span class="nc">Date</span> <span class="nf">dateFromString</span><span class="o">(</span><span class="nc">String</span> <span class="n">dateStr</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// "2022-01-01"</span>
	<span class="k">return</span> <span class="no">DATE_FORMAT</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">dateStr</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div></div>

<h4 id="javatimedatetimeformatter">java.time.DateTimeFormatter</h4>

<p>Java 8의 DateTimeFormatter 클래스에서는 format과 관련된 풍부한 기능을 제공합니다. <code class="language-plaintext highlighter-rouge">DateTimeFormatter.ofPattern</code> 를 통해 직접 format을 설정할 수도 있고 이미 제공되는 여러 format을 활용할 수도 있습니다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ofPattern</span><span class="o">(</span><span class="s">"yyyy-MM-dd HH:mm:ss"</span><span class="o">)</span>

<span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">BASIC_ISO_DATE</span><span class="o">;</span> <span class="c1">//  '20111203'</span>
<span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ISO_DATE</span><span class="o">;</span> <span class="c1">// '2011-12-03' or '2011-12-03+01:00'</span>
<span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ISO_LOCAL_DATE</span><span class="o">;</span> <span class="c1">//  '2011-12-03'</span>
<span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ISO_LOCAL_TIME</span><span class="o">;</span> <span class="c1">//  '10:15' or '10:15:30'</span>
<span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ISO_LOCAL_DATE_TIME</span><span class="o">;</span> <span class="c1">//  '2011-12-03T10:15:30'</span>
<span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ISO_OFFSET_DATE_TIME</span><span class="o">;</span> <span class="c1">// '2011-12-03T10:15:30+01:00'</span>
<span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ISO_ZONED_DATE_TIME</span><span class="o">;</span> <span class="c1">// '2011-12-03T10:15:30+01:00[Europe/Paris]'</span>
</code></pre></div></div>

<ul>
  <li>LocalDate, LocalDateTime -&gt; String</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nc">LocalDate</span><span class="o">&gt;.</span><span class="na">format</span><span class="o">(</span><span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">BASIC_ISO_DATE</span><span class="o">);</span>
<span class="o">&lt;</span><span class="nc">LocalDateTime</span><span class="o">&gt;.</span><span class="na">format</span><span class="o">(</span><span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ofPattern</span><span class="o">(</span><span class="s">"yyyy-MM-dd HH:mm:ss"</span><span class="o">));</span>
</code></pre></div></div>

<ul>
  <li>String -&gt; LocalDate, LocalDateTime</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">LocalDate</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"1995-05-09"</span><span class="o">);</span>
<span class="nc">LocalDate</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"20191224"</span><span class="o">,</span> <span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">BASIC_ISO_DATE</span><span class="o">);</span> 

<span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"2019-12-25T10:15:30"</span><span class="o">);</span>
<span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"2019-12-25 12:30:00"</span><span class="o">,</span> <span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ofPattern</span><span class="o">(</span><span class="s">"yyyy-MM-dd HH:mm:ss"</span><span class="o">));</span>
</code></pre></div></div>

<ul>
  <li>ZonedDateTime -&gt; String</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nc">ZonedDateTime</span><span class="o">&gt;.</span><span class="na">format</span><span class="o">(</span><span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ISO_ZONED_DATE_TIME</span><span class="o">);</span> <span class="c1">// ex. 2022-03-12T17:26:05.840250+09:00[Asia/Seoul]</span>
<span class="o">&lt;</span><span class="nc">ZonedDateTime</span><span class="o">&gt;.</span><span class="na">format</span><span class="o">(</span><span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ISO_OFFSET_DATE_TIME</span><span class="o">);</span> <span class="c1">// ex. 2022-03-12T17:26:05.840250+09:00</span>
</code></pre></div></div>

<ul>
  <li>String -&gt; ZonedDateTime</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">input</span> <span class="o">=</span> <span class="s">"2022-03-12T17:26:05.840250+09:00[Asia/Seoul]"</span>
<span class="nc">ZonedDateTime</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
</code></pre></div></div>

<h2 id="preserve-date-time-consistency-in-application">Preserve Date, Time Consistency in Application</h2>

<p>어플리케이션이 가지고 있는 대부분의 기능은 시간과 관련이 있습니다. 예를 들어 Uber의 배차 시스템에서 고객에게 드라이버를 매칭하기 위해서는 고객이 언제 배차 요청을 했는지, 드라이버들 중에서 후보 드라이버는 얼만큼 대기하고 있었는지, 기대 소요시간은 얼마인지 등 여러 시간 데이터들을 가지고 배차 시스템이 동작합니다.</p>

<p>하나의 어플리케이션은 다수의 웹 서버, 어플리케이션 서버, 데이터베이스 등 다양한 시스템이 긴밀하게 연결되어있는데요. 어플리케이션에 제대로 동작하려면 이들 시스템 간에 시간 데이터를 주고 받거나 영속적으로 저장할 때 시간 데이터의 일관성을 지키는 것이 매우 중요합니다. 그렇지 않으면 시간 역전 등의 문제로 인해 예측 및 분석하기가 어려운 장애가 발생할 수 있습니다. 일관성을 지키기 위해서는 다음의 두가지 규칙을 지켜야 합니다.</p>

<ul>
  <li>시간 데이터를 주고 받을 때 표준을 통해 주고 받습니다. (ISO-8601)</li>
  <li>시간 데이터를 저장할 때 요청 서버와 데이터베이스의 시간대 차이를 고려하여 시간을 변환하여 저장합니다.</li>
</ul>

<h3 id="iso-8601">ISO-8601</h3>

<p>ISO-8601은 date, time 관련 데이터들을 주고 받기 위한 국제 표준입니다. 잘 정의된 명확한 포맷을 통해서 날짜 및 시간 데이터를 주고 받을 때 잘못 해석되는 것을 방지하기 위한 표준이며 1988년에 처음 도입된 이후로 몇번의 개정이 있었습니다.</p>

<p>날짜, 주, 일, 등 시간을 나타내는 표준이 각각 존재하지만, 특정 지역에서의 시간대를 포함하여 시간을 표현하기 위해서 ISO-8601에서는 아래 포맷을 사용합니다. 시간에 관한 전체 정보를 모든 시스템이 동의하는 표준으로 주고 받으므로 직렬화, 역직렬화 중에도 데이터가 손실되거나 왜곡될 일 없이 일관성을 유지할 수 있습니다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yyyy-MM-dd'T'HH:mm:ss'Z' (UTC)
yyyy-MM-dd'T'HH:mm:ss+HH:ss (offset)
</code></pre></div></div>

<h3 id="database">Database</h3>

<p>서버들 간에 시간 데이터의 일관성을 지키기 위해서 ISO-8601 표준을 지키는 것과 더불어 데이터베이스에서는 시간 데이터를 저장하고 이후에 서버의 요청으로부터 응답을 내려줄 때도 일관성을 지킬 책임이 있습니다.</p>

<p>MySQL에서는 요청 서버와 데이터베이스 서버의 시간대, 그리고 사용자 정의 시간대를 고려하여 시간을 변환하여 저장하기 위한 설정을 제공합니다. MySQL에서 시간 데이터를 어떻게 저장하는지에 대해서는 아래 글에서 추가적으로 알아보겠습니다.</p>

<p>(더보기)</p>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://medium.com/javarevisited/the-evolution-of-the-java-date-time-api-bfdc61375ddb">https://medium.com/javarevisited/the-evolution-of-the-java-date-time-api-bfdc61375ddb</a></li>
  <li><a href="https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html">https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html</a></li>
  <li><a href="https://d2.naver.com/helloworld/645609">Naver D2 - Java의 날짜와 시간 API</a></li>
  <li><a href="https://en.wikipedia.org/wiki/ISO_8601">https://en.wikipedia.org/wiki/ISO_8601</a></li>
  <li><a href="https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-time-instants.html">https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-time-instants.html</a></li>
</ul>



    </div>

</article>
<div class="post-nav">
<a class="previous" href="/jekyll-theme-yat/database/2022/01/15/mysql-preserve-date-time-coherence.html" title="MySQL Preserve Date-Time Coherence">MySQL Preserve Date-Time Coherence</a><a class="next" href="/jekyll-theme-yat/stream-processing/2022/06/01/apache-kafka-troubleshoot.html" title="Apache Kafka - Troubleshoot">Apache Kafka - Troubleshoot</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/jekyll-theme-yat/database/2022/01/15/mysql-preserve-date-time-coherence.html" title="Apache Kafka - Troubleshoot">MySQL Preserve Date-Time Coherence</a></li>
<li><a class="post-link" href="/jekyll-theme-yat/distributed-systems/2020/08/23/paper-review-the-google-file-system-2.html" title="Apache Kafka - Troubleshoot">(Paper Review) The Google File System - Part 2</a></li>
<li><a class="post-link" href="/jekyll-theme-yat/distributed-systems/2020/08/23/paper-review-the-google-file-system-1.html" title="Apache Kafka - Troubleshoot">(Paper Review) The Google File System - Part 1</a></li>
<li><a class="post-link" href="/jekyll-theme-yat/java/2022/02/19/java-date-time-api.html" title="Apache Kafka - Troubleshoot">Java Date Time API</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title">TOC</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items) {
      var items = menuContent.firstChild.children;

      if (over_items == undefined) {
        over_items = 20;
      }

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/jekyll-theme-yat/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
<div>Unpublished Work <span class="copyleft">©</span> 2017-2024 TaeHyeok Jang</div>
      <div>Powered by <a title="Jekyll is a simple, blog-aware, static site
      generator." href="http://jekyllrb.com/">Jekyll</a> &amp; <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      <div class="footer-col rss-subscribe">Subscribe <a href="/jekyll-theme-yat/feed.xml">via RSS</a>
</div>
    </div>
  </div>
</footer>
</body>
</html>
